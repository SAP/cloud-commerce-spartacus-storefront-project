<ng-container *ngIf="tableData">
  <div class="desktop mode">
    <table class="table cx-table">
      <thead>
        <th scope="col" *ngFor="let column of columns">
          {{ column.value }}
        </th>
      </thead>
      <tbody>
        <tr *ngFor="let row of tableData">
          <td class="cx-code" *ngFor="let column of columns">
            <ng-container
              *ngTemplateOutlet="
                content;
                context: { data: { row: row, column: column } }
              "
            ></ng-container>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="mobile mode">
    <div class="cx-row" *ngFor="let row of tableData">
      <div
        *ngFor="let column of columns"
        [ngClass]="{ 'cx-action': column?.checkBox || column?.button }"
      >
        <span class="cx-label">{{ column.value }}: </span>
        <ng-container
          *ngTemplateOutlet="
            content;
            context: { data: { row: row, column: column } }
          "
        ></ng-container>
      </div>
    </div>
  </div>
</ng-container>

<!-- 
  Template for rendering checkbox input if `checkBox` property exists in column data. 

  Checkbox can be used as follows in tableData object:
  
  key: {
    ...,
    selected: true
  }
-->
<ng-template #checkbox let-row="row" let-column="column">
  <ng-container *ngIf="column?.checkBox && row">
    <input
      type="checkbox"
      [checked]="row[column.key]"
      (change)="onToggle($event, row, column.key)"
    />
  </ng-container>
</ng-template>

<!-- 
  Template for rendering icon button if `button` property exists in column data. 

  Icon button can be used as follows in tableData object:
  
  key: {
    button: {
      class: 'btn btn-primary btn-sm',
      disabled: true,
      icon: {
        type: this.iconTypes.CLOSE,
      },
      text: {
        class: 'desktop mode',
        value: 'Custom text',
      },
    },
  }
-->
<ng-template #button let-row="row" let-column="column">
  <ng-container *ngIf="column?.button && row">
    <button
      *ngIf="row[column.key]?.button"
      (click)="onClick($event, row, column.key)"
      [ngClass]="row[column.key].button?.class"
      [disabled]="row[column.key].button?.disabled"
      type="button"
    >
      <cx-icon
        *ngIf="row[column.key].button?.icon"
        [type]="row[column.key].button?.icon.type"
      ></cx-icon>
      <span [ngClass]="row[column.key].button?.text?.class">
        {{ row[column.key].button?.text?.value || column.value }}</span
      >
    </button>
  </ng-container>
</ng-template>

<!-- Template for rendering link based on `cxRoute` property in column data. -->
<ng-template #link let-row="row" let-column="column">
  <ng-container *ngIf="column?.cxRoute && row">
    <a
      [routerLink]="{ cxRoute: column.cxRoute, params: row } | cxUrl"
      class="cx-value"
    >
      {{ row[column.key] }}
    </a>
  </ng-container>
</ng-template>

<!-- Template for rendering plain text in case if any other custom properties not exist. -->
<ng-template #text let-row="row" let-column="column">
  <ng-container
    *ngIf="!column?.checkBox && !column?.button && !column?.cxRoute && row"
  >
    {{ row[column.key] || '-' }}
  </ng-container>
</ng-template>

<!-- Main content tempalate. -->
<ng-template #content let-data="data">
  <ng-container
    *ngTemplateOutlet="
      checkbox;
      context: { row: data.row, column: data.column }
    "
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="button; context: { row: data.row, column: data.column }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="link; context: { row: data.row, column: data.column }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="text; context: { row: data.row, column: data.column }"
  ></ng-container>
</ng-template>
