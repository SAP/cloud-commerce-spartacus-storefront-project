<h3 *ngIf="(service.title$ | async) as title">{{ title }}</h3>

<ng-container
  *ngIf="{
    max: service.itemSize$ | async,
    products: service.items$ | async,
    activeItem: service.activeItem$ | async
  } as carousel"
>activeItem$: {{carousel.activeItem}}, activeItem: {{service.activeItem}},itemSize$: {{carousel.max}}, itemSize: {{service.itemSize}}
  <div class="cx-carousel" [ngClass]="'size-' + carousel.max">
    <button
      class="previous"
      (click)="
        service.setPreviousItemAsActive()
      "
      [disabled]="carousel.activeItem === 0"
    ></button>

    <div class="groups">
      <ng-container *ngFor="let unused of carousel.products; let i = index">
        <div class="group" *ngIf="i % carousel.max === 0">
          <ng-container
            *ngFor="
              let product$ of (carousel.products | slice: i:i + carousel.max)
            "
          >
            <a
              *ngIf="(product$ | async) as product"
              class="product"
              [class.active]="i === carousel.activeItem"
              [routerLink]="
                { route: [{ name: 'product', params: product }] }
                  | cxTranslateUrl
              "
            >
              <cx-picture
                [imageContainer]="product.images?.PRIMARY"
                imageFormat="product"
              >
              </cx-picture>

              <h4>{{ product.name }}</h4>
              <div class="price">{{ product.price?.formattedValue }}</div>
            </a>
          </ng-container>
        </div>
      </ng-container>
    </div>

    <button
      class="next"
      (click)="service.setNextItemAsActive()"
      [disabled]="carousel.activeItem > carousel.products.length - carousel.max"
    ></button>
  </div>

  <div class="indicators">
    <ng-container *ngFor="let unused of carousel.products; let i = index">
      <button
        *ngIf="i % carousel.max === 0"
        (click)="service.setItemAsActive(i)"
        [disabled]="i === carousel.activeItem"
      ></button>
    </ng-container></div
></ng-container>
