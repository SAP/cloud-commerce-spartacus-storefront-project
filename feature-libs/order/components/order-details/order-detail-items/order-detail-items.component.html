<ng-container *ngIf="order$ | async as order">
  <ng-container
    *ngIf="
      order.consignments?.length ||
      order.unconsignedEntries?.length ||
      order.replenishmentOrderCode
    "
  >
    <cx-promotions
      [promotions]="order.appliedOrderPromotions || []"
    ></cx-promotions>
  </ng-container>

  <!-- pickup consigned entries -->
  <cx-order-consigned-entries
    *ngIf="pickupConsignments$ | async as consignments"
    [order]="order"
    [consignments]="consignments"
    [enableAddToCart]="enableAddToCart$ | async"
    [buyItAgainTranslation]="'addToCart.buyItAgain' | cxTranslate"
  ></cx-order-consigned-entries>

  <!-- delivery info
  <div class="cx-summary-card">
    <ng-container *ngIf="order.deliveryAddress">
      <cx-card
        [content]="getAddressCardContent(order.deliveryAddress) | async"
      ></cx-card>
    </ng-container>

    <ng-container *ngIf="order.deliveryMode">
      <cx-card
        [content]="getDeliveryModeCardContent(order.deliveryMode) | async"
      ></cx-card>
    </ng-container>
  </div>
 -->

  <!-- delivery consigned entries -->
  <cx-order-consigned-entries
    *ngIf="deliveryConsignments$ | async as consignments"
    [order]="order"
    [consignments]="consignments"
    [enableAddToCart]="enableAddToCart$ | async"
    [buyItAgainTranslation]="'addToCart.buyItAgain' | cxTranslate"
  ></cx-order-consigned-entries>

  <!-- unconsigned entries OR any entries -->
  <ng-container
    *ngIf="
      order?.unconsignedEntries?.length ||
      (order?.entries && order?.replenishmentOrderCode)
    "
  >
    <div class="cx-list row">
      <div *ngIf="order?.statusDisplay" class="cx-list-header col-12">
        <div class="cx-list-status">
          {{
            'orderDetails.statusDisplay_' + order?.statusDisplay | cxTranslate
          }}
        </div>
      </div>
      <div class="cx-list-item col-12">
        <ng-template
          [cxOutlet]="CartOutlets.CART_ITEM_LIST"
          [cxOutletContext]="{
            items: order?.unconsignedEntries
              ? order.unconsignedEntries
              : order.entries,
            readonly: true,
            promotionLocation: promotionLocation,
            options: {
              displayAddToCart: enableAddToCart$ | async,
              addToCartString: 'addToCart.buyItAgain' | cxTranslate,
              optionalBtn: addToCartBtn
            }
          }"
        >
        </ng-template>
      </div>
    </div>
  </ng-container>
</ng-container>

<ng-template let-ctx #addToCartBtn>
  <cx-add-to-cart
    [productCode]="ctx.item.product?.code"
    [product]="ctx.item.product"
    [showQuantity]="false"
    [options]="ctx.options"
    [pickupStore]="ctx.item.deliveryPointOfService?.name"
    class="add-to-cart"
  >
  </cx-add-to-cart>
</ng-template>
