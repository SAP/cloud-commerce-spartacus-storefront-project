<ng-container *ngIf="cart$ | async as cart">
  <div class="cx-cart-quick-order-form-title">
    {{ 'quickOrderCartForm.title' | cxTranslate }}
  </div>
  <div class="form-group">
    <form (ngSubmit)="applyQuickOrder()" [formGroup]="quickOrderForm">
      <div class="cx-cart-quick-order-form-container">
        <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
        <ng-container
          *cxFeature="
            '!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
          "
        >
          <!-- TODO: (CXSPA-5953) Remove feature flags next major -->
          <p *cxFeature="'a11yRequiredAsterisks'" class="form-legend">
            {{ 'formLegend.required' | cxTranslate }}
          </p>
        </ng-container>
        <span class="cx-cart-quick-order-form-productID">
          <label class="cx-cart-quick-order-form-label">
            {{ 'quickOrderCartForm.productCodeLabel' | cxTranslate }}
            <ng-template [ngTemplateOutlet]="requiredAsterisk"></ng-template>
          </label>

          <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
          <ng-container
            *cxFeature="
              'a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
            "
          >
            <input
              [attr.aria-label]="
                'quickOrderCartForm.entryProductCode' | cxTranslate
              "
              class="form-control input-product-code"
              formControlName="productCode"
              placeholder="{{
                'quickOrderCartForm.productCodePlaceholder' | cxTranslate
              }}"
              type="text"
            />
          </ng-container>

          <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
          <ng-container
            *cxFeature="
              '!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
            "
          >
            <input
              [attr.aria-label]="
                'quickOrderCartForm.entryProductCode' | cxTranslate
              "
              aria-required="true"
              class="form-control input-product-code"
              formControlName="productCode"
              required="true"
              placeholder="{{
                'quickOrderCartForm.productCodePlaceholder' | cxTranslate
              }}"
              type="text"
            />
          </ng-container>
        </span>

        <span class="cx-cart-quick-order-form-qty">
          <label
            *cxFeature="'a11yQTY2Quantity'"
            class="cx-cart-quick-order-form-label"
          >
            {{ 'quickOrderCartForm.quantityFullLabel' | cxTranslate }}
            <ng-template [ngTemplateOutlet]="requiredAsterisk"></ng-template>
          </label>

          <label
            *cxFeature="'!a11yQTY2Quantity'"
            class="cx-cart-quick-order-form-label"
          >
            {{ 'quickOrderCartForm.quantityLabel' | cxTranslate }}
            <ng-template [ngTemplateOutlet]="requiredAsterisk"></ng-template>
          </label>

          <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
          <ng-container
            *cxFeature="
              'a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
            "
          >
            <input
              [attr.aria-label]="'quickOrderCartForm.quantity' | cxTranslate"
              class="form-control input-quantity"
              formControlName="quantity"
              type="number"
            />
          </ng-container>

          <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
          <ng-container
            *cxFeature="
              '!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
            "
          >
            <input
              [attr.aria-label]="'quickOrderCartForm.quantity' | cxTranslate"
              aria-required="true"
              class="form-control input-quantity"
              formControlName="quantity"
              required="true"
              type="number"
            />
          </ng-container>
        </span>

        <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
        <ng-container
          *cxFeature="
            'a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
          "
        >
          <button
            [attr.aria-label]="'quickOrderCartForm.addToCart' | cxTranslate"
            [class.disabled]="cartIsLoading$ | async"
            [disabled]="
              (cartIsLoading$ | async) ||
              !quickOrderForm?.get('productCode')?.value ||
              !quickOrderForm?.get('quantity')?.value
            "
            class="btn btn-block btn-secondary apply-quick-order-button"
            type="submit"
          >
            {{ 'quickOrderCartForm.add' | cxTranslate }}
          </button>
        </ng-container>

        <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
        <ng-container
          *cxFeature="
            '!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
          "
        >
          <button
            [attr.aria-label]="'quickOrderCartForm.addToCart' | cxTranslate"
            [class.disabled]="cartIsLoading$ | async"
            [disabled]="cartIsLoading$ | async"
            class="btn btn-block btn-secondary apply-quick-order-button"
            type="submit"
          >
            {{ 'quickOrderCartForm.add' | cxTranslate }}
          </button>

          <!-- TODO: (CXSPA-7315) Remove feature toggle in the next major -->
          <cx-form-errors
            *cxFeature="'formErrorsDescriptiveMessages'"
            [translationParams]="{
              label: 'quickOrderCartForm.productCodeLabel' | cxTranslate,
            }"
            [control]="quickOrderForm.get('productCode')"
          ></cx-form-errors>

          <cx-form-errors
            *cxFeature="'!formErrorsDescriptiveMessages'"
            [control]="quickOrderForm.get('productCode')"
          ></cx-form-errors>

          <cx-form-errors
            *cxFeature="'formErrorsDescriptiveMessages'"
            [translationParams]="{
              label: 'quickOrderCartForm.quantityFullLabel' | cxTranslate,
            }"
            [control]="quickOrderForm.get('quantity')"
          ></cx-form-errors>

          <cx-form-errors
            *cxFeature="'!formErrorsDescriptiveMessages'"
            [control]="quickOrderForm.get('quantity')"
          ></cx-form-errors>
        </ng-container>
      </div>
    </form>
  </div>
</ng-container>

<ng-template #requiredAsterisk>
  <!-- TODO: (CXSPA-7479) Remove feature flags next major -->
  <ng-container
    *cxFeature="
      '!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields'
    "
  >
    <!-- TODO: (CXSPA-5953) Remove feature flags next major -->
    <abbr
      *cxFeature="'a11yRequiredAsterisks'"
      class="text-decoration-none"
      aria-hidden="true"
      title="{{ 'common.required' | cxTranslate }}"
      >*</abbr
    >
  </ng-container>
</ng-template>
