<form [formGroup]="form" class="quick-order-form-container">
  <div class="quick-order-form-input">
    <input
      (blur)="onBlur($event.relatedTarget)"
      (keydown.arrowdown)="focusNextChild()"
      (keydown.arrowup)="focusPreviousChild()"
      (keydown.enter)="addProduct($event)"
      (keydown.escape)="clear($event)"
      [attr.aria-label]="'common.search' | cxTranslate"
      class="form-control"
      formControlName="product"
      placeholder="{{ 'quickOrderForm.placeholder' | cxTranslate }}"
      type="text"
    />

    <cx-icon
      (click)="clear($event)"
      [type]="iconTypes.RESET"
      class="reset"
      tabindex="-1"
    ></cx-icon>
    <cx-icon [type]="iconTypes.SEARCH" class="search" tabindex="-1"></cx-icon>

    <cx-form-errors [control]="form.get('product')"></cx-form-errors>

    <span *ngIf="isDisabled" class="list-limit-reached-text">
      {{ 'quickOrderForm.listLimitReached' | cxTranslate }}
    </span>
  </div>

  <div role="listbox" class="quick-order-results">
    <ng-container *ngIf="results$ | async as results">
      <ul class="quick-order-results-products" tabindex="0">
        <li
          *ngFor="let product of results; let i = index"
          (click)="add(product, $event)"
          (keydown.enter)="add(product, $event)"
          (keydown.escape)="clear($event)"
          [class.has-media]="config.displayProductImages"
          [ngClass]="{ active: getFocusedElementIndex() === i }"
          class="quick-order-results-product"
        >
          <cx-media
            *ngIf="config.displayProductImages"
            [container]="product.images?.PRIMARY"
            class="media"
            format="thumbnail"
            role="presentation"
          ></cx-media>
          <div class="name" [innerHTML]="product.name"></div>
          <span class="stock">
            {{ 'addToCart.' + product.stock?.stockLevelStatus | cxTranslate }}
          </span>
          <span class="price">{{ product.price?.formattedValue }}</span>
        </li>
      </ul>
    </ng-container>
  </div>
</form>
