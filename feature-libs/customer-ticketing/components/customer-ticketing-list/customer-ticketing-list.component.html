<ng-container *ngIf="{
  ticketsObs: tickets$ | async,
  tickets: tickets | async
} as ticketList">
  <h3 class="cx-ticketing-list-title">
    <span class="cx-ticketing-list-title-text">
      {{ 'customerTicketingList.requestTitle' | cxTranslate }}
    </span>
    <span class="cx-ticketing-list-title-count">
      ({{ ticketList.tickets.length }})
    </span>
  </h3>

  <div class="cx-ticketing-list-sort top">
    <label class="cx-ticketing-list-form-group form-group">
      <span>
        {{ 'customerTicketingList.sortSubtitle' | cxTranslate }}
      </span>
      <cx-sorting
        [sortOptions]="ticketList.ticketsObs.sorts"
        [sortLabels]="getSortLabels() | async"
        (sortListEvent)="changeSortCode($event)"
        [selectedOption]="ticketList.ticketsObs.pagination.sort"
        placeholder="{{ 'customerTicketingList.sortSubtitle' | cxTranslate }}"
        [ariaLabel]="'customerTicketingList.sortOrders' | cxTranslate"
        ariaControls="ticketing-list-table"
      ></cx-sorting>
    </label>
    <div
      *ngIf="ticketList.ticketsObs.pagination.totalPages > 1"
      class="cx-ticketing-list-pagination"
    >
      <cx-pagination
        [pagination]="ticketList.ticketsObs.pagination"
        (viewPageEvent)="pageChange($event)"
      ></cx-pagination>
    </div>
  </div>

  <ng-container *ngIf="customerTicketsFlag">
    <div class="cx-ticketing-list-mobile" *ngFor="let ticket of ticketList.tickets">
      <div>
        <div class="cx-ticketing-list-ticket-item-mobile-description">
          <span class="col-4 cx-ticketing-list-ticket-item-mobile">
          {{ 'customerTicketingList.mobile.ticketIdFull' | cxTranslate }}
          </span>
          <span class="col-8">
          {{ ticket.id }}
          </span>
        </div>
        <div class="cx-ticketing-list-ticket-item-mobile-description">
          <span class="col-4 cx-ticketing-list-ticket-item-mobile">
          {{ 'customerTicketingList.subject' | cxTranslate }}
          </span>
          <span class="col-8">
          {{ ticket.subject }}
          </span>
        </div>
        <div class="cx-ticketing-list-ticket-item-mobile-description">
          <span class="col-4 cx-ticketing-list-ticket-item-mobile">
          {{ 'customerTicketingList.ticketCategory' | cxTranslate }}
          </span>
          <span class="col-8">
          {{ ticket.ticketCategory }}
          </span>
        </div>
        <div class="cx-ticketing-list-ticket-item-mobile-description">
          <span class="col-4 cx-ticketing-list-ticket-item-mobile">
          {{ 'customerTicketing.createdOn' | cxTranslate }}
          </span>
          <span class="col-8">
          {{ ticket.createdAt | cxDate }}
          </span>
        </div>
        <div class="cx-ticketing-list-ticket-item-mobile-description">
          <span class="col-4 cx-ticketing-list-ticket-item-mobile">
          {{ 'customerTicketing.changedOn' | cxTranslate }}
          </span>
          <span class="col-8">
          {{ ticket.modifiedAt | cxDate }}
          </span>
        </div>
        <div class="cx-ticketing-list-ticket-item-mobile-description">
          <span class="col-4 cx-ticketing-list-ticket-item-mobile">
          {{ 'customerTicketing.status' | cxTranslate }}
          </span>
          <span class="col-8" [ngClass]="getStatusClass(ticket.status.id)">
          {{ ticket.status.name }}
          </span>
        </div>
      </div>
    </div>
    <table id="ticketing-list-table" class="table cx-ticketing-list-table">
      <thead>
        <tr>
          <th scope="col">{{ 'customerTicketing.ticketId' | cxTranslate }}</th>
          <th scope="col">{{ 'customerTicketingList.subject' | cxTranslate }}</th>
          <th scope="col">{{ 'customerTicketingList.ticketCategory' | cxTranslate }}</th>
          <th scope="col">{{ 'customerTicketing.createdOn' | cxTranslate }}</th>
          <th scope="col">{{ 'customerTicketing.changedOn' | cxTranslate }}</th>
          <th scope="col">{{ 'customerTicketing.status' | cxTranslate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ticket of ticketList.tickets">
          <td>
            <a 
              [routerLink]="{cxRoute: 'supportTicketDetails', params: ticket.id } | cxUrl">
              {{ ticket.id }}
            </a>
          </td>
          <td>
            <a 
              [routerLink]="{cxRoute: 'supportTicketDetails', params: ticket.id } | cxUrl">
              {{ ticket.subject }}
            </a>
          </td>
          <td>{{ ticket.ticketCategory }}</td>
          <td>{{ ticket.createdAt | cxDate }}</td>
          <td>{{ ticket.modifiedAt | cxDate }}</td>
          <td [ngClass]="getStatusClass(ticket.status.id)">{{ ticket.status.name }}</td>
        </tr>
      </tbody>
    </table>
    <div class="cx-ticketing-list-sort bottom">
      <div
        *ngIf="ticketList.ticketsObs.pagination.totalPages > 1"
        class="cx-ticketing-list-pagination"
      >
        <cx-pagination
          [pagination]="ticketList.ticketsObs.pagination"
          (viewPageEvent)="pageChange($event)"
        ></cx-pagination>
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="!customerTicketsFlag">
    <div class="text-center">
      <h3>{{ 'customerTicketingList.noTickets' | cxTranslate }}</h3>
    </div>
  </ng-container>